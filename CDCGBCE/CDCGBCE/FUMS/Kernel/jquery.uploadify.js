jQuery&&(function(a){a.extend(a.fn,{uploadify:function(b){a(this).each(function(){var c=a.extend({id:a(this).attr("id"),uploader:"uploadify.swf",script:"uploadify.php",expressInstall:null,folder:"",height:30,width:120,cancelImg:"cancel.png",wmode:"opaque",scriptAccess:"sameDomain",fileDataName:"Filedata",method:"POST",queueSizeLimit:999,simUploadLimit:1,queueID:false,displayData:"percentage",removeCompleted:true,onInit:function(){},onSelect:function(){},onSelectOnce:function(){},onQueueFull:function(){},onCheck:function(){},onCancel:function(){},onClearQueue:function(){},onError:function(){},onProgress:function(){},onComplete:function(){},onAllComplete:function(){}},b);a(this).data("settings",c);var e=location.pathname;e=e.split("/");e.pop();e=e.join("/")+"/";var d={};d.uploadifyID=c.id;d.pagepath=e;if(c.buttonImg)d.buttonImg=escape(c.buttonImg);if(c.buttonText)d.buttonText=escape(c.buttonText);if(c.rollover)d.rollover=true;d.script=c.script;d.folder=escape(c.folder);if(c.scriptData){var f="";for(var h in c.scriptData)f+="&"+h+"="+c.scriptData[h];d.scriptData=escape(f.substr(1))}d.width=c.width;d.height=c.height;d.wmode=c.wmode;d.method=c.method;d.queueSizeLimit=c.queueSizeLimit;d.simUploadLimit=c.simUploadLimit;if(c.hideButton)d.hideButton=true;if(c.fileDesc)d.fileDesc=c.fileDesc;if(c.fileExt)d.fileExt=c.fileExt;if(c.multi)d.multi=true;if(c.auto)d.auto=true;if(c.sizeLimit)d.sizeLimit=c.sizeLimit;if(c.checkScript)d.checkScript=c.checkScript;if(c.fileDataName)d.fileDataName=c.fileDataName;if(c.queueID)d.queueID=c.queueID;if(c.onInit()!==false){a(this).css("display","none");a(this).after('<div id="'+a(this).attr("id")+'Uploader"></div>');swfobject.embedSWF(c.uploader,c.id+"Uploader",c.width,c.height,"9.0.24",c.expressInstall,d,{quality:"high",wmode:c.wmode,allowScriptAccess:c.scriptAccess},{},function(a){typeof c.onSWFReady=="function"&&a.success&&c.onSWFReady()});if(c.queueID==false)a("#"+a(this).attr("id")+"Uploader").after('<div id="'+a(this).attr("id")+'Queue" class="uploadifyQueue"></div>');else a("#"+c.queueID).addClass("uploadifyQueue")}typeof c.onOpen=="function"&&a(this).bind("uploadifyOpen",c.onOpen);a(this).bind("uploadifySelect",{action:c.onSelect,queueID:c.queueID},function(f,g,d){if(f.data.action(f,g,d)!==false){var b=Math.round(d.size/1024*100)*.01,h="KB";if(b>1e3){b=Math.round(b*.001*100)*.01;h="MB"}var e=b.toString().split(".");if(e.length>1)b=e[0]+"."+e[1].substr(0,2);else b=e[0];if(d.name.length>20)fileName=d.name.substr(0,20)+"...";else fileName=d.name;queue="#"+a(this).attr("id")+"Queue";if(f.data.queueID)queue="#"+f.data.queueID;a(queue).append('<div id="'+a(this).attr("id")+g+'" class="uploadifyQueueItem">\t\t\t\t\t\t\t\t<div class="cancel">\t\t\t\t\t\t\t\t\t<a href="javascript:jQuery(\'#'+a(this).attr("id")+"').uploadifyCancel('"+g+'\')"><img src="'+c.cancelImg+'" border="0" /></a>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<span class="fileName">'+fileName+" ("+b+h+')</span><span class="percentage"></span>\t\t\t\t\t\t\t\t<div class="uploadifyProgress">\t\t\t\t\t\t\t\t\t<div id="'+a(this).attr("id")+g+'ProgressBar" class="uploadifyProgressBar"><!--Progress Bar--></div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>')}});a(this).bind("uploadifySelectOnce",{action:c.onSelectOnce},function(b,d){b.data.action(b,d);if(c.auto)if(c.checkScript)a(this).uploadifyUpload(null,false);else a(this).uploadifyUpload(null,true)});a(this).bind("uploadifyQueueFull",{action:c.onQueueFull},function(b,a){b.data.action(b,a)!==false&&alert("The queue is full.  The max size is "+a+".")});a(this).bind("uploadifyCheckExist",{action:c.onCheck},function(b,i,f,d,g){var c={};c=f;c.folder=d.substr(0,1)=="/"?d:e+d;if(g)for(var j in f)var h=j;a.post(i,c,function(c){for(var d in c)if(b.data.action(b,c,d)!==false){var e=confirm("Do you want to replace the file "+c[d]+"?");!e&&document.getElementById(a(b.target).attr("id")+"Uploader").cancelFileUpload(d,true,true)}if(g)document.getElementById(a(b.target).attr("id")+"Uploader").startFileUpload(h,true);else document.getElementById(a(b.target).attr("id")+"Uploader").startFileUpload(null,true)},"json")});a(this).bind("uploadifyCancel",{action:c.onCancel},function(c,d,f,h,g,b){if(c.data.action(c,d,f,h,b)!==false)if(g){var e=b==true?0:250;a("#"+a(this).attr("id")+d).fadeOut(e,function(){a(this).remove()})}});a(this).bind("uploadifyClearQueue",{action:c.onClearQueue},function(e,b){var d=c.queueID?c.queueID:a(this).attr("id")+"Queue";b&&a("#"+d).find(".uploadifyQueueItem").remove();e.data.action(e,b)!==false&&a("#"+d).find(".uploadifyQueueItem").each(function(){var b=a(".uploadifyQueueItem").index(this);a(this).delay(b*100).fadeOut(250,function(){a(this).remove()})})});var g=[];a(this).bind("uploadifyError",{action:c.onError},function(e,b,d,c){if(e.data.action(e,b,d,c)!==false){var f=[b,d,c];g.push(f);a("#"+a(this).attr("id")+b).find(".percentage").text(" - "+c.type+" Error");a("#"+a(this).attr("id")+b).find(".uploadifyProgress").hide();a("#"+a(this).attr("id")+b).addClass("uploadifyError")}});typeof c.onUpload=="function"&&a(this).bind("uploadifyUpload",c.onUpload);a(this).bind("uploadifyProgress",{action:c.onProgress,toDisplay:c.displayData},function(b,d,e,c){if(b.data.action(b,d,e,c)!==false){a("#"+a(this).attr("id")+d+"ProgressBar").animate({width:c.percentage+"%"},250,function(){c.percentage==100&&a(this).closest(".uploadifyProgress").fadeOut(250,function(){a(this).remove()})});if(b.data.toDisplay=="percentage")displayData=" - "+c.percentage+"%";if(b.data.toDisplay=="speed")displayData=" - "+c.speed+"KB/s";if(b.data.toDisplay==null)displayData=" ";a("#"+a(this).attr("id")+d).find(".percentage").text(displayData)}});a(this).bind("uploadifyComplete",{action:c.onComplete},function(b,d,f,e,g){if(b.data.action(b,d,f,unescape(e),g)!==false){a("#"+a(this).attr("id")+d).find(".percentage").text(" - Completed");c.removeCompleted&&a("#"+a(b.target).attr("id")+d).fadeOut(250,function(){a(this).remove()});a("#"+a(b.target).attr("id")+d).addClass("completed")}});typeof c.onAllComplete=="function"&&a(this).bind("uploadifyAllComplete",{action:c.onAllComplete},function(a,b){if(a.data.action(a,b)!==false)g=[]})})},uploadifySettings:function(d,b,i){var c=false;a(this).each(function(){if(d=="scriptData"&&b!=null){if(i)var f=b;else var f=a.extend(a(this).data("settings").scriptData,b);var e="";for(var g in f)e+="&"+g+"="+f[g];b=escape(e.substr(1))}c=document.getElementById(a(this).attr("id")+"Uploader").updateSettings(d,b)});if(b==null)if(d=="scriptData"){for(var f=unescape(c).split("&"),g={},e=0;e<f.length;e++){var h=f[e].split("=");g[h[0]]=h[1]}c=g}return c},uploadifyUpload:function(c,b){a(this).each(function(){if(!b)b=false;document.getElementById(a(this).attr("id")+"Uploader").startFileUpload(c,b)})},uploadifyCancel:function(b){a(this).each(function(){document.getElementById(a(this).attr("id")+"Uploader").cancelFileUpload(b,true,true,false)})},uploadifyClearQueue:function(){a(this).each(function(){document.getElementById(a(this).attr("id")+"Uploader").clearFileUploadQueue(false)})}})})(jQuery)